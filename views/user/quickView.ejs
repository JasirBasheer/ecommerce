<%- include('../layouts/user/header') -%>

<style>
    #star-rating .star {
    cursor: pointer;
    font-size: 2rem;
    color: #ddd;
}

#star-rating .star:hover,
#star-rating .star:hover ~ .star {
    color: #f5c518;
}

#star-rating .star {
    transition: color 0.3s;
}


.review .col-auto {
    width: 147px;
    padding-right: 2rem;
}


</style>

    <div class="page-wrapper">
       
    <header class="header">
            

        <div class="header-middle sticky-header">
            <div class="container">
                <div class="header-left">
                    <button class="mobile-menu-toggler">
                        <span class="sr-only">Toggle mobile menu</span>
                        <i class="icon-bars"></i>
                    </button>

                    <a href="/" class="logo">
                        <img src="assets/images/logo.png" alt="Wood Street Logo" width="105" height="25">
                    </a>

                    <nav class="main-nav">
                        <ul class="menu sf-arrows">
                            <li >
                                <a href="/" class="sf-with">Home</a>

                            </li>
                            <li class="megamenu-container active">
                                <a href="/shop" class="sf-with">Shop</a>

                        
                            </li>
                            <li>
                                <a href="/about" class="sf-with">About</a>
                            </li>
                            <li>
                                <a href="/contactus" class="sf-with">Contact Us</a>

                                
                            </li>
                            <li>
                                <a href="/blog" class="sf-with">Blog</a>

                                
                            </li>
                            
                        </ul><!-- End .menu -->
                    </nav><!-- End .main-nav -->
                </div><!-- End .header-left -->

                <div class="header-right">
                    <div class="header-search">
                        <a href="#" class="search-toggle" role="button" title="Search"><i class="icon-search"></i></a>
                        <form action="#" method="get">
                            <div class="header-search-wrapper">
                                <label for="q" class="sr-only">Search</label>
                                <input type="search" class="form-control" name="q" id="q" placeholder="Search in..." required>
                            </div><!-- End .header-search-wrapper -->
                        </form>
                    </div><!-- End .header-search -->
                    <a href="/wishlist" class="wishlist-link">
                        <i class="icon-heart-o"></i>
                        <% if (typeof wishlistCount != 'undefined') { %>
                            <span class="wishlist-count" id="wishlistcount"><%= wishlistCount %></span>
                        <% }else{ %>
                            <span class="wishlist-count">0</span>

                        <% } %>
                    </a>

                    <div class="dropdown cart-dropdown" onclick="loadCart()">
                        <a href="/cart" class="dropdown-toggle" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-display="static">
                            <i class="icon-shopping-cart"></i>
                            <% if (typeof cartCount !== 'undefined') { %>
                                <span class="cart-count" id="cartcount"><%= cartCount %></span>
                            <% } else { %>
                                <span class="cart-count" id="cartcount">0</span>
                            <% } %>
                
                        </a> 
                        <input type="hidden" value="<%= userId %>" id="checkuserId">
                        <input type="hidden" value="<%= product.num_of_stocks %>" id="num_of_stocks">

                        
                    </div>
                    <a href="/user" class="wishlist-link">
                     <i class="icon-user"></i>
                    </a>
                </div><!-- End .header-right -->
            </div><!-- End .container -->
        </div><!-- End .header-middle -->
    </header><!-- End .header -->

        <main class="main">
            <nav aria-label="breadcrumb" class="breadcrumb-nav border-0 mb-0">
                <div class="container d-flex align-items-center">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                        <li class="breadcrumb-item"><a href="#">Products</a></li>
                        <li class="breadcrumb-item active" aria-current="page"><%=product.productCategory%></li>
                    </ol>

                    <nav class="product-pager ml-auto" aria-label="Product">
                        <a class="product-pager-link product-pager-prev" href="#" aria-label="Previous" tabindex="-1">
                            <i class="icon-angle-left"></i>
                            <span>Prev</span>
                        </a>

                        <a class="product-pager-link product-pager-next" href="#" aria-label="Next" tabindex="-1">
                            <span>Next</span>
                            <i class="icon-angle-right"></i>
                        </a>
                    </nav><!-- End .pager-nav -->
                </div><!-- End .container -->
            </nav><!-- End .breadcrumb-nav -->

            <div class="page-content">
                <div class="container">
                    <div class="product-details-top mb-2">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="product-gallery product-gallery-vertical">
                                    <div class="row">
                                        <figure class="product-main-image">
                                           
                                            <img id="product-zoom" src="<%= product.images[0]%>" data-zoom-image="<%= product.images[0]%>" alt="product image">

                                            <a href="#" id="btn-product-gallery" class="btn-product-gallery">
                                                <i class="icon-arrows"></i>
                                            </a>
                                        </figure><!-- End .product-main-image -->

                                        <div id="product-zoom-gallery" class="product-image-gallery">
                                            <% for( let i = 0; i < product.images.length; i++ ) { %>
                                                <a class="product-gallery-item <%= i === 0 ? 'active' : '' %>" href="#" data-image="<%= product.images[i]%>" data-zoom-image="<%= product.images[i]%>">
                                                    <img src="<%= product.images[i]%>" alt="product side">
                                                </a>
                                            <% } %>
                                         

                                        </div><!-- End .product-image-gallery -->
                                    </div><!-- End .row -->
                                </div><!-- End .product-gallery -->
                            </div><!-- End .col-md-6 -->

                            <div class="col-md-6 ">
                                <div class="product-details product-details ">
                                    <h1 class="product-title"><%= product.productName%></h1><!-- End .product-title -->

                                    <div class="ratings-container" style="text-align: left;">
                                        <div class="ratings">
                                            <div class="ratings-val" style="width: 80%;"></div><!-- End .ratings-val -->
                                        </div><!-- End .ratings -->
                                        <a class="ratings-text" href="#product-review-link" id="review-link">( 2 Reviews )</a>
                                    </div><!-- End .rating-container -->

                                    <div class="product-price" style="text-align: left;">
                                        â‚¹ <%= product.productPrice%>
                                    </div><!-- End .product-price -->

                                    <div class="product-content" style="text-align: left;border-top: .1rem solid #ebebeb;border-bottom: .1rem solid #ebebeb;"  >
                                        <p class="mt-2 mb-2">
                                            <% if (orderedDetails.orderStatus== "Delivered") { %>
                                            Delivered
                                            <% }else{ %>
                                            Delivery 

                                                <% } %>
                                            to : <%= orderedDetails.addresss.fullName%>
										<br>
										Ordered Quantity : <%= orderedQuantity  %>
										<br>
										House : <%= orderedDetails.addresss.house%>
										<br>
										Street : <%= orderedDetails.addresss.street%>
										<br>
										 Number : <%= orderedDetails.addresss.number%>
										<br>
										City : <%= orderedDetails.addresss.city%>
										<br>
										State : <%= orderedDetails.addresss.state%>

									</p>
                                    </div><!-- End .product-content -->
                                    <% if (orderedDetails.orderStatus== "Delivered") { %>
                                        
                                    <% if (orderedDetails.expectedDeliveryDate) { %>
                                        <% 
                                            const currentDate = new Date();
                                            const expectedDate = new Date(orderedDetails.expectedDeliveryDate);
                                            const threeDaysBeforeExpected = new Date(expectedDate);
                                            threeDaysBeforeExpected.setDate(expectedDate.getDate() - 3);
                                    
                                            if (currentDate <= threeDaysBeforeExpected) { 
                                        %>
                                        <div style="margin-bottom: 11px;">
    <a  
       onclick="handleReturnProduct('<%= orderedDetails._id %>', '<%= product._id %>')" 
       style="text-decoration: underline;cursor: pointer;">
       Return product ?
    </a>
    <br>
</div>

                                                                            <% } else { %>
                                            <p>The current date is greater than the expected delivery date minus 3 days.</p>
                                        <% } %>
                                    <% } %>
                                    <% } %>

                                    
                               

                                    

                                    
                                   

                                    <div class="product-details-action">
                                        <div class="details-action-col">                                                      
                                              <% if (product.num_of_stocks<=0) { %>



                                                            <h6 style="color: red;">Prodcut is currently unavailable </h6>

                                                        
                                                        <% }else{ %>
                                                            <div class="product-details-quantity">
                                                                <input type="number" id="qty" class="form-control" value="1" min="1" max="5" step="1" data-decimals="0" required>
                                                            </div><!-- End .product-details-quantity -->
                                                            <a  onclick="handleAddToCart('<%=product._id %>')" style="cursor: pointer;" class="btn-product btn-cart"><span>Buy again</span></a>
                                                            <br>
                                                            <input type="hidden" value="<%= userId %>" id="checkuserId">
                                                            <input type="hidden" value="<%= product.num_of_stocks %>" id="num_of_stocks">

                                                            
                                            <% } %>

                                        </div>
										<br>
									
                                        <p id="quantityerror" style="color: red;"></p>

                                    </div><!-- End .product-details-action -->

                                    <div class="product-details-footer">
                                        <div class="product-cat">
                                            <span>Category:</span>
                                            <a href="#"><%= product.productCategory%></a>
                                            
                                        </div><!-- End .product-cat -->

                                        <div class="social-icons social-icons-sm">
                                            <span class="social-label">Share:</span>
                                            <a href="#" class="social-icon" title="Facebook" target="_blank"><i class="icon-facebook-f"></i></a>
                                            <a href="#" class="social-icon" title="Twitter" target="_blank"><i class="icon-twitter"></i></a>
                                            <a href="#" class="social-icon" title="Instagram" target="_blank"><i class="icon-instagram"></i></a>
                                            <a href="#" class="social-icon" title="Pinterest" target="_blank"><i class="icon-pinterest"></i></a>
                                        </div>
                                    </div><!-- End .product-details-footer -->
                                </div><!-- End .product-details -->
                            </div><!-- End .col-md-6 -->
                        </div><!-- End .row -->
                    </div>

                    <div class="product-details-tab">
                        <ul class="nav nav-pills justify-content-center" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link active" id="product-desc-link" data-toggle="tab" href="#product-desc-tab" role="tab" aria-controls="product-desc-tab" aria-selected="true">Description</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="product-info-link" data-toggle="tab" href="#product-info-tab" role="tab" aria-controls="product-info-tab" aria-selected="false">Additional information</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="product-shipping-link" data-toggle="tab" href="#product-shipping-tab" role="tab" aria-controls="product-shipping-tab" aria-selected="false">Shipping & Returns</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="product-review-link" data-toggle="tab" href="#product-review-tab" role="tab" aria-controls="product-review-tab" aria-selected="false">Reviews (<%=product.reviews.length%>)</a>
                            </li>
                        </ul>
                        <div class="tab-content">
                            <div class="tab-pane fade show active" id="product-desc-tab" role="tabpanel" aria-labelledby="product-desc-link">
                                <div class="product-desc-content">
                                    <h3>Product Information</h3>
                                    <p><%= product.productDescription%></p>
                                </div><!-- End .product-desc-content -->
                            </div><!-- .End .tab-pane -->
                            <div class="tab-pane fade" id="product-info-tab" role="tabpanel" aria-labelledby="product-info-link">
                                <div class="product-desc-content">
                                    <h3>Information</h3>
                                    <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Donec odio. Quisque volutpat mattis eros. Nullam malesuada erat ut turpis. Suspendisse urna viverra non, semper suscipit, posuere a, pede. Donec nec justo eget felis facilisis fermentum. Aliquam porttitor mauris sit amet orci. </p>

                                    <h3>Fabric & care</h3>
                                    <ul>
                                        <li>Faux suede fabric</li>
                                        <li>Gold tone metal hoop handles.</li>
                                        <li>RI branding</li>
                                        <li>Snake print trim interior </li>
                                        <li>Adjustable cross body strap</li>
                                        <li> Height: 31cm; Width: 32cm; Depth: 12cm; Handle Drop: 61cm</li>
                                    </ul>

                                    <h3>Size</h3>
                                    <p>one size</p>
                                </div><!-- End .product-desc-content -->
                            </div><!-- .End .tab-pane -->
                            <div class="tab-pane fade" id="product-shipping-tab" role="tabpanel" aria-labelledby="product-shipping-link">
                                <div class="product-desc-content">
                                    <h3>Delivery & returns</h3>
                                    <p>We deliver to over 100 countries around the world. For full details of the delivery options we offer, please view our <a href="#">Delivery information</a><br>
                                    We hope youâ€™ll love every purchase, but if you ever need to return an item you can do so within a month of receipt. For full details of how to make a return, please view our <a href="#">Returns information</a></p>
                                </div><!-- End .product-desc-content -->
                            </div><!-- .End .tab-pane -->
                            <div class="tab-pane fade" id="product-review-tab" role="tabpanel" aria-labelledby="product-review-link">
                                <input type="hidden" id="productIdr" value="<%= product._id%>">
                                <% if (orderedDetails.orderStatus== "Delivered") { %>
                                     <div class="reviews">

                                        
                                    <div class="review">
        <div class="row no-gutters">
            <div class="col-12 ">
    <h4><a href="#">Add Review :</a></h4>
</div>
<div class="col">
    <form id="review-form">
        <div class="form-group">
            <textarea id="review-text" name="reviewText" class="form-control" rows="4" placeholder="Write your review here..."></textarea>
        </div>
        <div style="cursor: pointer;" class="form-group">
            <label for="rating">Rating:</label>
            <div id="star-rating">
                <span class="star" data-value="1">â˜…</span>
                <span class="star" data-value="2">â˜…</span>
                <span class="star" data-value="3">â˜…</span>
                <span class="star" data-value="4">â˜…</span>
                <span class="star" data-value="5">â˜…</span>
            </div>
            <input type="hidden" id="rating" name="rating" value="0">
            <input type="hidden" id="userName" name="rating" value="<%= orderedDetails.addresss.fullName%>">
        </div>
        <button type="submit" class="btn btn-primary">Submit Review</button>
    </form>
</div>

            
        </div><!-- End .row -->
    </div><!-- End .review -->




    <% if (product.reviews.length!= 0) { %>
        <% for (let i = product.reviews.length-1; i >=0 ; i--) {%>
        
            <div class="review">
                                        <div class="row no-gutters">
                                            <div class="col-auto">
                                                <h4><a style="min-width: 2rem;" href="#"><%=product.reviews[i].name%></a></h4>
                                                <div class="ratings-container">
                                                    <div class="ratings">
                                                        <div class="ratings-val" style="width: <%=product.reviews[i].rating%>%"></div><!-- End .ratings-val -->
                                                    </div><!-- End .ratings -->
                                                </div><!-- End .rating-container -->
                                                <span class="review-date">

                                                    <% 
                                                      const date =product.reviews[i].date
                                                      const day = String(date.getDate()).padStart(2, '0');
                                                      const month = String(date.getMonth() + 1).padStart(2, '0');
                                                      const year = date.getFullYear();
                                                      const formattedDate = `${day}/${month}/${year}`;
                                                 %>
                                                 <%= formattedDate %>
                                                    
                                                    </span>
                                            </div><!-- End .col -->
                                            <div class="col">

                                                <div class="review-content">
                                                    <p><%=product.reviews[i].review%></p>
                                                </div><!-- End .review-content -->

                                            </div><!-- End .col-auto -->
                                        </div><!-- End .row -->
                                    </div><!-- End .review -->
            
            <%   } %>        
        <%}else{%>
            <p>no reviews</p>
        <%}%>
                        
                                   
                                   
                                    

                                <% }else{ %>
                                    

    <% if (product.reviews.length!= 0) { %>
        <% for (let i = 0; i < product.reviews.length; i++) {%>
        
            <div class="review">
                                        <div class="row no-gutters">
                                            <div class="col-auto">
                                                <h4><a href="#"><%=product.reviews[i].name%></a></h4>
                                                <div class="ratings-container">
                                                    <div class="ratings">
                                                        <div class="ratings-val" style="width:<%=product.reviews[i].rating%>%"></div><!-- End .ratings-val -->
                                                    </div><!-- End .ratings -->
                                                </div><!-- End .rating-container -->
                                                <span class="review-date">
                                                    <% 
                                                      const date =product.reviews[i].date
                                                      const day = String(date.getDate()).padStart(2, '0');
                                                      const month = String(date.getMonth() + 1).padStart(2, '0');
                                                      const year = date.getFullYear();
                                                      const formattedDate = `${day}/${month}/${year}`;
                                                 %>
                                                 <%= formattedDate %>
                                                    </span>
                                            </div><!-- End .col -->
                                            <div class="col">

                                                <div class="review-content">
                                                    <p><%=product.reviews[i].review%></p>
                                                </div><!-- End .review-content -->

                                      
                                            </div><!-- End .col-auto -->
                                        </div><!-- End .row -->
                                    </div><!-- End .review -->
            
            <%   } %>        
        <%}else{%>
            <p>no reviews</p>
        <%}%>
                                <% } %>
                               
                               
                               
                               
                               
                            </div><!-- .End .tab-pane -->
                        </div><!-- End .tab-content -->
                    </div><!-- End .product-details-tab -->
                    
                </div><!-- End .container -->
            </div><!-- End .page-content -->
        </main><!-- End .main -->

        <footer class="footer">
        	<div class="footer-middle">
	            <div class="container">
	            	<div class="row">
	            		<div class="col-sm-6 col-lg-3">
	            			<div class="widget widget-about">
	            				<img src="assets/images/logo.png" class="footer-logo" alt="Footer Logo" width="105" height="25">
	            				<p>Praesent dapibus, neque id cursus ucibus, tortor neque egestas augue, eu vulputate magna eros eu erat. </p>

	            				<div class="social-icons">
	            					<a href="#" class="social-icon" target="_blank" title="Facebook"><i class="icon-facebook-f"></i></a>
	            					<a href="#" class="social-icon" target="_blank" title="Twitter"><i class="icon-twitter"></i></a>
	            					<a href="#" class="social-icon" target="_blank" title="Instagram"><i class="icon-instagram"></i></a>
	            					<a href="#" class="social-icon" target="_blank" title="Youtube"><i class="icon-youtube"></i></a>
	            					<a href="#" class="social-icon" target="_blank" title="Pinterest"><i class="icon-pinterest"></i></a>
	            				</div><!-- End .soial-icons -->
	            			</div><!-- End .widget about-widget -->
	            		</div><!-- End .col-sm-6 col-lg-3 -->

	            		<div class="col-sm-6 col-lg-3">
	            			<div class="widget">
	            				<h4 class="widget-title">Useful Links</h4><!-- End .widget-title -->

	            				<ul class="widget-list">
	            					<li><a href="about.html">About Wood Street</a></li>
	            					<li><a href="#">How to shop on Wood Street</a></li>
	            					<li><a href="#">FAQ</a></li>
	            					<li><a href="contact.html">Contact us</a></li>
	            					<li><a href="login.html">Log in</a></li>
	            				</ul><!-- End .widget-list -->
	            			</div><!-- End .widget -->
	            		</div><!-- End .col-sm-6 col-lg-3 -->

	            		<div class="col-sm-6 col-lg-3">
	            			<div class="widget">
	            				<h4 class="widget-title">Customer Service</h4><!-- End .widget-title -->

	            				<ul class="widget-list">
	            					<li><a href="#">Payment Methods</a></li>
	            					<li><a href="#">Money-back guarantee!</a></li>
	            					<li><a href="#">Returns</a></li>
	            					<li><a href="#">Shipping</a></li>
	            					<li><a href="#">Terms and conditions</a></li>
	            					<li><a href="#">Privacy Policy</a></li>
	            				</ul><!-- End .widget-list -->
	            			</div><!-- End .widget -->
	            		</div><!-- End .col-sm-6 col-lg-3 -->

	            		<div class="col-sm-6 col-lg-3">
	            			<div class="widget">
	            				<h4 class="widget-title">My Account</h4><!-- End .widget-title -->

	            				<ul class="widget-list">
	            					<li><a href="#">Sign In</a></li>
	            					<li><a href="cart.html">View Cart</a></li>
	            					<li><a href="#">My Wishlist</a></li>
	            					<li><a href="#">Track My Order</a></li>
	            					<li><a href="#">Help</a></li>
	            				</ul><!-- End .widget-list -->
	            			</div><!-- End .widget -->
	            		</div><!-- End .col-sm-6 col-lg-3 -->
	            	</div><!-- End .row -->
	            </div><!-- End .container -->
	        </div><!-- End .footer-middle -->

	        <div class="footer-bottom">
	        	<div class="container">
	        		<p class="footer-copyright">Copyright Â© 2019 Wood Street Store. All Rights Reserved.</p><!-- End .footer-copyright -->
	        		<figure class="footer-payments">
	        			<img src="assets/images/payments.png" alt="Payment methods" width="272" height="20">
	        		</figure><!-- End .footer-payments -->
	        	</div><!-- End .container -->
	        </div><!-- End .footer-bottom -->
        </footer><!-- End .footer -->
    </div><!-- End .page-wrapper -->
    <button id="scroll-top" title="Back to Top"><i class="icon-arrow-up"></i></button>

    <!-- Mobile Menu -->
    <div class="mobile-menu-overlay"></div><!-- End .mobil-menu-overlay -->

    <div class="mobile-menu-container">
        <div class="mobile-menu-wrapper">
            <span class="mobile-menu-close"><i class="icon-close"></i></span>

            <form action="#" method="get" class="mobile-search">
                <label for="mobile-search" class="sr-only">Search</label>
                <input type="search" class="form-control" name="mobile-search" id="mobile-search" placeholder="Search in..." required>
                <button class="btn btn-primary" type="submit"><i class="icon-search"></i></button>
            </form>
            
            <nav class="mobile-nav">
                <ul class="mobile-menu">
                    <li class="active">
                        <a href="index.html">Home</a>

                        <ul>
                            <li><a href="index-1.html">01 - furniture store</a></li>
                            <li><a href="index-2.html">02 - furniture store</a></li>
                            <li><a href="index-3.html">03 - electronic store</a></li>
                            <li><a href="index-4.html">04 - electronic store</a></li>
                            <li><a href="index-5.html">05 - fashion store</a></li>
                            <li><a href="index-6.html">06 - fashion store</a></li>
                            <li><a href="index-7.html">07 - fashion store</a></li>
                            <li><a href="index-8.html">08 - fashion store</a></li>
                            <li><a href="index-9.html">09 - fashion store</a></li>
                            <li><a href="index-10.html">10 - shoes store</a></li>
                            <li><a href="index-11.html">11 - furniture simple store</a></li>
                            <li><a href="index-12.html">12 - fashion simple store</a></li>
                            <li><a href="index-13.html">13 - market</a></li>
                            <li><a href="index-14.html">14 - market fullwidth</a></li>
                            <li><a href="index-15.html">15 - lookbook 1</a></li>
                            <li><a href="index-16.html">16 - lookbook 2</a></li>
                            <li><a href="index-17.html">17 - fashion store</a></li>
                            <li><a href="index-18.html">18 - fashion store (with sidebar)</a></li>
                            <li><a href="index-19.html">19 - games store</a></li>
                            <li><a href="index-20.html">20 - book store</a></li>
                            <li><a href="index-21.html">21 - sport store</a></li>
                            <li><a href="index-22.html">22 - tools store</a></li>
                            <li><a href="index-23.html">23 - fashion left navigation store</a></li>
                            <li><a href="index-24.html">24 - extreme sport store</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="category.html">Shop</a>
                        <ul>
                            <li><a href="category-list.html">Shop List</a></li>
                            <li><a href="category-2cols.html">Shop Grid 2 Columns</a></li>
                            <li><a href="category.html">Shop Grid 3 Columns</a></li>
                            <li><a href="category-4cols.html">Shop Grid 4 Columns</a></li>
                            <li><a href="category-boxed.html"><span>Shop Boxed No Sidebar<span class="tip tip-hot">Hot</span></span></a></li>
                            <li><a href="category-fullwidth.html">Shop Fullwidth No Sidebar</a></li>
                            <li><a href="product-category-boxed.html">Product Category Boxed</a></li>
                            <li><a href="product-category-fullwidth.html"><span>Product Category Fullwidth<span class="tip tip-new">New</span></span></a></li>
                            <li><a href="cart.html">Cart</a></li>
                            <li><a href="checkout.html">Checkout</a></li>
                            <li><a href="wishlist.html">Wishlist</a></li>
                            <li><a href="#">Lookbook</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="product.html" class="sf-with-ul">Product</a>
                        <ul>
                            <li><a href="product.html">Default</a></li>
                            <li><a href="product-centered.html">Centered</a></li>
                            <li><a href="product-extended.html"><span>Extended Info<span class="tip tip-new">New</span></span></a></li>
                            <li><a href="product-gallery.html">Gallery</a></li>
                            <li><a href="product-sticky.html">Sticky Info</a></li>
                            <li><a href="product-sidebar.html">Boxed With Sidebar</a></li>
                            <li><a href="product-fullwidth.html">Full Width</a></li>
                            <li><a href="product-masonry.html">Masonry Sticky Info</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="#">Pages</a>
                        <ul>
                            <li>
                                <a href="about.html">About</a>

                                <ul>
                                    <li><a href="about.html">About 01</a></li>
                                    <li><a href="about-2.html">About 02</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="contact.html">Contact</a>

                                <ul>
                                    <li><a href="contact.html">Contact 01</a></li>
                                    <li><a href="contact-2.html">Contact 02</a></li>
                                </ul>
                            </li>
                            <li><a href="login.html">Login</a></li>
                            <li><a href="faq.html">FAQs</a></li>
                            <li><a href="404.html">Error 404</a></li>
                            <li><a href="coming-soon.html">Coming Soon</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="blog.html">Blog</a>

                        <ul>
                            <li><a href="blog.html">Classic</a></li>
                            <li><a href="blog-listing.html">Listing</a></li>
                            <li>
                                <a href="#">Grid</a>
                                <ul>
                                    <li><a href="blog-grid-2cols.html">Grid 2 columns</a></li>
                                    <li><a href="blog-grid-3cols.html">Grid 3 columns</a></li>
                                    <li><a href="blog-grid-4cols.html">Grid 4 columns</a></li>
                                    <li><a href="blog-grid-sidebar.html">Grid sidebar</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="#">Masonry</a>
                                <ul>
                                    <li><a href="blog-masonry-2cols.html">Masonry 2 columns</a></li>
                                    <li><a href="blog-masonry-3cols.html">Masonry 3 columns</a></li>
                                    <li><a href="blog-masonry-4cols.html">Masonry 4 columns</a></li>
                                    <li><a href="blog-masonry-sidebar.html">Masonry sidebar</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="#">Mask</a>
                                <ul>
                                    <li><a href="blog-mask-grid.html">Blog mask grid</a></li>
                                    <li><a href="blog-mask-masonry.html">Blog mask masonry</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="#">Single Post</a>
                                <ul>
                                    <li><a href="single.html">Default with sidebar</a></li>
                                    <li><a href="single-fullwidth.html">Fullwidth no sidebar</a></li>
                                    <li><a href="single-fullwidth-sidebar.html">Fullwidth with sidebar</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="elements-list.html">Elements</a>
                        <ul>
                            <li><a href="elements-products.html">Products</a></li>
                            <li><a href="elements-typography.html">Typography</a></li>
                            <li><a href="elements-titles.html">Titles</a></li>
                            <li><a href="elements-banners.html">Banners</a></li>
                            <li><a href="elements-product-category.html">Product Category</a></li>
                            <li><a href="elements-video-banners.html">Video Banners</a></li>
                            <li><a href="elements-buttons.html">Buttons</a></li>
                            <li><a href="elements-accordions.html">Accordions</a></li>
                            <li><a href="elements-tabs.html">Tabs</a></li>
                            <li><a href="elements-testimonials.html">Testimonials</a></li>
                            <li><a href="elements-blog-posts.html">Blog Posts</a></li>
                            <li><a href="elements-portfolio.html">Portfolio</a></li>
                            <li><a href="elements-cta.html">Call to Action</a></li>
                            <li><a href="elements-icon-boxes.html">Icon Boxes</a></li>
                        </ul>
                    </li>
                </ul>
            </nav><!-- End .mobile-nav -->

            <div class="social-icons">
                <a href="#" class="social-icon" target="_blank" title="Facebook"><i class="icon-facebook-f"></i></a>
                <a href="#" class="social-icon" target="_blank" title="Twitter"><i class="icon-twitter"></i></a>
                <a href="#" class="social-icon" target="_blank" title="Instagram"><i class="icon-instagram"></i></a>
                <a href="#" class="social-icon" target="_blank" title="Youtube"><i class="icon-youtube"></i></a>
            </div><!-- End .social-icons -->
        </div><!-- End .mobile-menu-wrapper -->
    </div><!-- End .mobile-menu-container -->

    <!-- Sign in / Register Modal -->
    <div class="modal fade" id="signin-modal" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true"><i class="icon-close"></i></span>
                    </button>

                    <div class="form-box">
                        <div class="form-tab">
                            <ul class="nav nav-pills nav-fill" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active" id="signin-tab" data-toggle="tab" href="#signin" role="tab" aria-controls="signin" aria-selected="true">Sign In</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="register-tab" data-toggle="tab" href="#register" role="tab" aria-controls="register" aria-selected="false">Register</a>
                                </li>
                            </ul>
                            <div class="tab-content" id="tab-content-5">
                                <div class="tab-pane fade show active" id="signin" role="tabpanel" aria-labelledby="signin-tab">
                                    <form action="#">
                                        <div class="form-group">
                                            <label for="singin-email">Username or email address *</label>
                                            <input type="text" class="form-control" id="singin-email" name="singin-email" required>
                                        </div><!-- End .form-group -->

                                        <div class="form-group">
                                            <label for="singin-password">Password *</label>
                                            <input type="password" class="form-control" id="singin-password" name="singin-password" required>
                                        </div><!-- End .form-group -->

                                        <div class="form-footer">
                                            <button type="submit" class="btn btn-outline-primary-2">
                                                <span>LOG IN</span>
                                                <i class="icon-long-arrow-right"></i>
                                            </button>

                                            <div class="custom-control custom-checkbox">
                                                <input type="checkbox" class="custom-control-input" id="signin-remember">
                                                <label class="custom-control-label" for="signin-remember">Remember Me</label>
                                            </div><!-- End .custom-checkbox -->

                                            <a href="#" class="forgot-link">Forgot Your Password?</a>
                                        </div><!-- End .form-footer -->
                                    </form>
                                    <div class="form-choice">
                                        <p class="text-center">or sign in with</p>
                                        <div class="row">
                                            <div class="col-sm-6">
                                                <a href="#" class="btn btn-login btn-g">
                                                    <i class="icon-google"></i>
                                                    Login With Google
                                                </a>
                                            </div><!-- End .col-6 -->
                                            <div class="col-sm-6">
                                                <a href="#" class="btn btn-login btn-f">
                                                    <i class="icon-facebook-f"></i>
                                                    Login With Facebook
                                                </a>
                                            </div><!-- End .col-6 -->
                                        </div><!-- End .row -->
                                    </div><!-- End .form-choice -->
                                </div><!-- .End .tab-pane -->
                                <div class="tab-pane fade" id="register" role="tabpanel" aria-labelledby="register-tab">
                                    <form action="#">
                                        <div class="form-group">
                                            <label for="register-email">Your email address *</label>
                                            <input type="email" class="form-control" id="register-email" name="register-email" required>
                                        </div><!-- End .form-group -->

                                        <div class="form-group">
                                            <label for="register-password">Password *</label>
                                            <input type="password" class="form-control" id="register-password" name="register-password" required>
                                        </div><!-- End .form-group -->

                                        <div class="form-footer">
                                            <button type="submit" class="btn btn-outline-primary-2">
                                                <span>SIGN UP</span>
                                                <i class="icon-long-arrow-right"></i>
                                            </button>

                                            <div class="custom-control custom-checkbox">
                                                <input type="checkbox" class="custom-control-input" id="register-policy" required>
                                                <label class="custom-control-label" for="register-policy">I agree to the <a href="#">privacy policy</a> *</label>
                                            </div><!-- End .custom-checkbox -->
                                        </div><!-- End .form-footer -->
                                    </form>
                                    <div class="form-choice">
                                        <p class="text-center">or sign in with</p>
                                        <div class="row">
                                            <div class="col-sm-6">
                                                <a href="#" class="btn btn-login btn-g">
                                                    <i class="icon-google"></i>
                                                    Login With Google
                                                </a>
                                            </div><!-- End .col-6 -->
                                            <div class="col-sm-6">
                                                <a href="#" class="btn btn-login  btn-f">
                                                    <i class="icon-facebook-f"></i>
                                                    Login With Facebook
                                                </a>
                                            </div><!-- End .col-6 -->
                                        </div><!-- End .row -->
                                    </div><!-- End .form-choice -->
                                </div><!-- .End .tab-pane -->
                            </div><!-- End .tab-content -->
                        </div><!-- End .form-tab -->
                    </div><!-- End .form-box -->
                </div><!-- End .modal-body -->
            </div><!-- End .modal-content -->
        </div><!-- End .modal-dialog -->
    </div><!-- End .modal -->

    <!-- Plugins JS File -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/jquery.hoverIntent.min.js"></script>
    <script src="assets/js/jquery.waypoints.min.js"></script>
    <script src="assets/js/superfish.min.js"></script>
    <script src="assets/js/owl.carousel.min.js"></script>
    <script src="assets/js/bootstrap-input-spinner.js"></script>
    <script src="assets/js/jquery.elevateZoom.min.js"></script>
    <script src="assets/js/bootstrap-input-spinner.js"></script>
    <script src="assets/js/jquery.magnific-popup.min.js"></script>
    <!-- Main JS File -->
    <script src="assets/js/main.js"></script>

    <script>
  
        
        function handleAddToCart(productId){
            const user = document.getElementById('checkuserId').value


            if(user ==""){
              
                window.location.href ="/login"
            }else{
            let quantity = parseInt(document.getElementById('qty').value)
            let num_of_stocks = parseInt(document.getElementById('num_of_stocks').value)
            console.log(quantity);
                if(quantity>num_of_stocks){
                    const quantityerror = document.getElementById('quantityerror')
                    quantityerror.textContent =`Product stock left is only ${num_of_stocks}`

                }else{
                    console.log(quantity);
            fetch('/addtocart',{
                method:'POST',
                headers:{
                    'Content-Type':'application/json'
                },
                body:JSON.stringify({productId , quantity})
                
            })
            .then(response => {

            
if (response.redirected) {

    window.location.href = response.url;
}else{
    return response.json()
}
})            .then(data=>{  
        if (data !== undefined) {
            Swal.fire({
        title: "Product added to cart",
        icon:"success",
        confirmButtonColor: "#CC9966",
        showCancelButton: true,
        confirmButtonText: 'Go to cart',
        cancelButtonText: 'Ok'
    }).then((result) => {
        if (result.isConfirmed) {
            window.location.href = '/cart'; 
        }
    })
            
            const cartCount = document.getElementById('cartcount');
            if (cartCount) {
                cartCount.textContent = data.count;
            }
        }
            })

                }

          
        }

            }

            function loadCart(){
        const user = document.getElementById('checkuserId').value

        if (user) {
            window.location.href='/cart'
            
        }else{
            window.location.href='/login'
        }
    }


    function handleReturnProduct(orderId, productId) {
        Swal.fire({
    title: "Are You Sure",
    icon: "warning",
    showCancelButton: true, 
    confirmButtonText: 'Yes, Return this product',
    cancelButtonText: 'No'
}).then((result) => {

    if (result.isConfirmed) {
        fetch('/returnproduct',{
            method:'POST',
            headers:{
                'Content-Type':'application/json'
            },
            body:JSON.stringify({orderId,productId})
        })
        .then(response => {

            
if (response.redirected) {

    window.location.href = response.url;
}else{
    return response.json()
}
})        .then(data=>{
            if(data.success){

                Swal.fire({
    title: "The prodcut amount will be credited to your wallet within 3 working days",
    icon: "success",
    confirmButtonText: 'Okey',
}).then((result) => {

    if (result.isConfirmed) {
        window.location.href ="/orderedlist?id="+ orderId

    }
})

            }
        })

    console.log('Order ID:', orderId);
    console.log('Product ID:', productId);
    
    }
});

        

       
    
}


    </script>


    <script>
        
const stars = document.querySelectorAll('#star-rating .star');
const ratingInput = document.getElementById('rating');
const reviewForm = document.getElementById('review-form');
const productId = document.getElementById('productIdr').value
const userName = document.getElementById('userName').value


stars.forEach(star => {
    star.addEventListener('click', function() {
        ratingInput.value = this.dataset.value;
        updateStars(this.dataset.value);
    });

    star.addEventListener('mouseover', function() {
        updateStars(this.dataset.value);
    });

    star.addEventListener('mouseout', function() {
        updateStars(ratingInput.value);
    });
});

function updateStars(value) {
    stars.forEach(star => {
        if (star.dataset.value <= value) {
            star.style.color = '#f5c518';
        } else {
            star.style.color = '#ddd';
        }
    });
}

reviewForm.addEventListener('submit', function(event) {
    event.preventDefault(); 

    const reviewText = document.getElementById('review-text').value;
    const rating = ratingInput.value;

    const data = {
        reviewText: reviewText,
        rating: rating,
        productId:productId,
        userName:userName
    };


    fetch('/addreview', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
    })
    .then(response => {

            
if (response.redirected) {

    window.location.href = response.url;
}else{
    return response.json()
}
})    .then(data => {
        if(data.success){
            Swal.fire({
        title: "Review successfully submited",
        text: "",
        confirmButtonColor: "#CC9966",
        confirmButtonText: 'Ok',
    }).then(() => {
            window.location.reload(); 
        });



    

        }

    })
    .catch(error => {
        console.error('Error:', error);

    });
});



        </script>

</body>


</html>