<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <title>Wood Street - Bring The Good Cart To Life.</title>
  <meta name="keywords" content="HTML5 Template" />
  <meta name="description" content=" - Bootstrap " />
  <meta name="author" content="p-themes" />
  <link rel="apple-touch-icon" sizes="180x180" href="assets/images/icons/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="assets/images/icons/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="assets/images/icons/favicon-16x16.png" />
  <link rel="manifest" href="assets/images/icons/site.html" />
  <link rel="mask-icon" href="assets/images/icons/safari-pinned-tab.svg" color="#666666" />
  <link rel="shortcut icon" href="assets/images/icons/favicon.ico" />
  <meta name="apple-mobile-web-app-title" content="spy" />
  <meta name="application-name" content="spy" />
  <meta name="msapplication-TileColor" content="#cc9966" />
  <meta name="msapplication-config" content="assets/images/icons/browserconfig.xml" />
  <meta name="theme-color" content="#ffffff" />
  <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
  <link rel="stylesheet" href="assets/css/plugins/owl-carousel/owl.carousel.css" />
  <link rel="stylesheet" href="assets/css/style.css" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous" />
  <link href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
    integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://cdn.datatables.net/v/bs5/jq-3.6.0/dt-1.13.4/sp-2.1.2/datatables.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="custom-assets/css/app.min.css">
    <!-- Template CSS -->
    <link rel="stylesheet" href="custom-assets/css/style.css">
    <link rel="stylesheet" href="custom-assets/css/components.css">
    <!-- Custom style CSS -->
    <link rel="stylesheet" href="custom-assets/css/custom.css">
    <style>
      .nav-tabs .nav-item .nav-link {
      color: #16110c;
  }
    </style>
</head>

<body>
  <div class="page-wrapper">
    <header class="header">
      <div class="header-top">
        <div class="container">
          <div class="header-left">
            <div class="header-dropdown">

            </div>

            <div class="header-dropdown">

            </div>
          </div>

          <div class="header-right">
            <div class="header-dropdown">
              <a href="#"><i class="icon-user"></i>My Account</a>
              <div class="header-menu">
                <ul>
                  <li><a href="#">Settings</a></li>
                  <li><a href="/admin/logout">Logout</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="header-middle sticky-header">
        <div class="container">
          <div class="header-left">
            <button class="mobile-menu-toggler">
              <span class="sr-only">Toggle mobile menu</span>
              <i class="icon-bars"></i>
            </button>

            <a href="/admin" class="logo">
              <img src="assets/images/logo.png" alt="Wood Street Logo" width="105" height="25">
            </a>

            <nav class="main-nav">
              <ul class="menu sf-arrows">
                <li class="megamenu-container">
                  <a href="/admin/">Home</a>
                </li>
                <li>
                  <a href="/admin/categorylist" class="sf-with-ul">Categories</a>
                  <ul>
                    <li><a href="/admin/categorylist">Category Lists</a></li>
                    <li><a href="/admin/addcategory">Add New Category</a></li>
                  </ul>
                </li>
                <li>
                  <a href="/admin/productslist" class="sf-with-ul">Products</a>
                  <ul>
                    <li>
                      <a href="/admin/productslist">Product Lists</a>
                    </li>
                    <li>
                      <a href="/admin/addproduct">Add New Product</a>
                    </li>
                  </ul>
                </li>
                <li>
                  <a href="/admin/couponslist" class="sf-with-ul">Coupons</a>
                  <ul>
                    <li>
                      <a href="/admin/couponslist">Coupon Lists</a>
                    </li>
                    <li>
                      <a href="/admin/addcoupon">Add New Coupon</a>
                    </li>
                  </ul>
                </li>
                <li><a href="/admin/userslist">Users</a></li>
                <li><a href="/admin/orderslist">Orders</a></li>
              </ul>
            </nav>
          </div>

          <!-- <div class="header-right">
              <div class="header-search">
                <a href="#" class="search-toggle" role="button" title="Search"
                  ><i class="icon-search"></i
                ></a>
                <form action="#" method="get">
                  <div class="header-search-wrapper">
                    <label for="q" class="sr-only">Search</label>
                    <input
                      type="search"
                      class="form-control"
                      name="q"
                      id="q"
                      placeholder="Search in..."
                      required
                    />
                  </div>
                  
                </form>
              </div>
              
            </div> -->
        </div>
      </div>
    </header>

    <main class="main mt-5">
      <div class="container">




        <div class="col-12 col-lg-12">
          <div class="card">
            <div class="card-header">
              <h4>Offers</h4>
            </div>
            <div class="card-body">
              <ul class="nav nav-tabs" id="myTab2" role="tablist">
                <li class="nav-item">
                  <a class="nav-link active" id="home-tab2" data-toggle="tab" href="#home2" role="tab" aria-controls="home" aria-selected="true">Product Offers</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" id="profile-tab2" data-toggle="tab" href="#profile2" role="tab" aria-controls="profile" aria-selected="false">Category Offers</a>
                </li>
              </ul>
              <div class="tab-content tab-bordered" id="myTab3Content">
                <div class="tab-pane fade active show" id="home2" role="tabpanel" aria-labelledby="home-tab2">
                  
                  
                  <div class="col-12">
                    <div class="card">
                      
                      <div class="card-body p-0">
                        <div class="table-responsive">
                          <table class="table table-striped">
                            <tbody>
                              <tr>
                              <th class="text-center">
                                
                              </th>
                              <th>Offer Name</th>
                              <th>Product</th>
                              <th>Discount</th>
                              <th>Action</th>
                            </tr>
                            <% if (typeof productOffers != "undefined") { %>
                              <% productOffers.forEach(product => { %>
                               
        

                            <tr id="product<%= product._id %>">
                              <td class="p-0 text-center">
                       
                              </td>
                              <td><%=product.offerName%></td>
                              <td class="text-truncate">
                                <%=product.productName%>
                              </td>
                              <td class="align-middle">
                                <%=product.offerPercentage%>
                              </td>
                              <td>

                                <button type="button" 
                                class="btn <%= product.isActive ? 'btn-danger' : 'btn-success' %> toggle-btn" 
                                onclick="toggleActivation('<%= product._id %>', <%= product.isActive %>)">
                                <%= product.isActive ? 'Deactivate' : 'Activate' %>
                                 </button>
                        
                        

                                <a href="/admin/editproductoffer?id=<%= product._id %>"
                                  style="margin-right: 1hhhh5px; margin-left: 15px; text-decoration: none;margin-right: 11px;">
                                 <span><i class="fa-sharp fa-solid fa-file-pen"></i></span>
                               </a>
                             <a onclick="deleteProductOffer('<%= product._id %>')" style="cursor: pointer;"><i class="fa-sharp fa-solid fa-trash" style="color: red;"></i>
                                       </a>   </td>

                              
                            </tr>
                            <% }) %>
                            <% } %>
                          </tbody></table>
                        </div>
                      </div>
                    </div>
                  </div>

                  



                </div>
                <div class="tab-pane fade" id="profile2" role="tabpanel" aria-labelledby="profile-tab2">
                 
                  


                  <div class="col-12">
                    <div class="card">
                      
                      <div class="card-body p-0">
                        <div class="table-responsive">
                          <table class="table table-striped">
                            <tbody>
                              <tr>
                                <th class="text-center"></th>
                                <th>Offer Name</th>
                                <th>Category</th>
                                <th>Discount</th>
                                <th>Action</th>
                              </tr>
                              <% if (typeof categoryOffers != "undefined") { %>
                                <% categoryOffers.forEach(category => { %>
                                  <tr id="category<%= category._id %>">
                                    <td class="p-0 text-center"></td>
                                    <td><%= category.offerName %></td>
                                    <td class="text-truncate"><%= category.categoryName %></td>
                                    <td class="align-middle"><%= category.offerPercentage %></td>
                                    <td>
                                      <button type="button" 
                                        class="btn <%= category.isActive ? 'btn-danger' : 'btn-success' %> toggle-btn" 
                                        onclick="toggleCategoryActivation('<%= category._id %>', <%= category.isActive %>)">
                                        <%= category.isActive ? 'Deactivate' : 'Activate' %>
                                      </button>
                                      <a href="/admin/editcategoryoffer?id=<%= category._id %>" 
                                        style="margin-right: 15px; margin-left: 15px; text-decoration: none;">
                                        <span><i class="fa-sharp fa-solid fa-file-pen"></i></span>
                                      </a>
                                      <a onclick="deleteCategoryOffer('<%= category._id %>')" style="cursor: pointer;">
                                        <i class="fa-sharp fa-solid fa-trash" style="color: red;"></i>
                                      </a>
                                    </td>
                                  </tr>
                                <% }) %>
                              <% } %>
                            </tbody>
                          </table>
                          
                        </div>
                      </div>
                    </div>
                  </div>




                </div>
              </div>
            </div>
          </div>
        </div>



      </div>
    </main>
    

    
        <footer class="footer">
          <!-- <div class="footer-middle">
          <div class="container">
            <div class="row">
              <div class="col-sm-6 col-lg-3">
                <div class="widget widget-about">
                  
                  <p>
                    Praesent dapibus, neque id cursus ucibus, tortor neque
                    egestas augue, eu vulputate magna eros eu erat.
                  </p>

                  <div class="social-icons">
                    <a
                      href="#"
                      class="social-icon"
                      target="_blank"
                      title="Facebook"
                      ><i class="icon-facebook-f"></i
                    ></a>
                    <a
                      href="#"
                      class="social-icon"
                      target="_blank"
                      title="Twitter"
                      ><i class="icon-twitter"></i
                    ></a>
                    <a
                      href="#"
                      class="social-icon"
                      target="_blank"
                      title="Instagram"
                      ><i class="icon-instagram"></i
                    ></a>
                    <a
                      href="#"
                      class="social-icon"
                      target="_blank"
                      title="Youtube"
                      ><i class="icon-youtube"></i
                    ></a>
                    <a
                      href="#"
                      class="social-icon"
                      target="_blank"
                      title="Pinterest"
                      ><i class="icon-pinterest"></i
                    ></a>
                  </div>
                  
                </div>
                
              </div>
              

              <div class="col-sm-6 col-lg-3">
                <div class="widget">
                  <h4 class="widget-title">Useful Links</h4>
                  

                  <ul class="widget-list">
                    <li><a href="about.html">About </a></li>
                    <li><a href="#">How to shop on </a></li>
                    <li><a href="#">FAQ</a></li>
                    <li><a href="contact.html">Contact us</a></li>
                    <li><a href="login.html">Log in</a></li>
                  </ul>
                  
                </div>
                
              </div>
              

              <div class="col-sm-6 col-lg-3">
                <div class="widget">
                  <h4 class="widget-title">Customer Service</h4>
                  

                  <ul class="widget-list">
                    <li><a href="#">Payment Methods</a></li>
                    <li><a href="#">Money-back guarantee!</a></li>
                    <li><a href="#">Returns</a></li>
                    <li><a href="#">Shipping</a></li>
                    <li><a href="#">Terms and conditions</a></li>
                    <li><a href="#">Privacy Policy</a></li>
                  </ul>
                  
                </div>
                
              </div>
              

              <div class="col-sm-6 col-lg-3">
                <div class="widget">
                  <h4 class="widget-title">My Account</h4>
                  

                  <ul class="widget-list">
                    <li><a href="#">Sign In</a></li>
                    <li><a href="cart.html">View Cart</a></li>
                    <li><a href="#">My Wishlist</a></li>
                    <li><a href="#">Track My Order</a></li>
                    <li><a href="#">Help</a></li>
                  </ul>
                  
                </div>
                
              </div>
              
            </div>
            
          </div>
          
        </div> -->


          <div class="footer-bottom">
            <div class="container">
              <p class="footer-copyright">
                Copyright Â©
                <script>document.write(new Date().getFullYear());</script> Wood Street Store. All Rights Reserved.
              </p>

              <!-- <figure class="footer-payments">
              <img
                src="assets/images/payments.png"
                alt="Payment methods"
                width="272"
                height="20"
              />
            </figure> -->

            </div>

          </div>

        </footer>
  </div>
  <button id="scroll-top" style="border-radius: 50%;background-color: rgba(255, 255, 255, 0.294);" title="Back to Top">
    <i class="icon-arrow-up"></i>
  </button>

  <div class="mobile-menu-overlay"></div>

  <div class="mobile-menu-container">
    <div class="mobile-menu-wrapper">
      <span class="mobile-menu-close"><i class="icon-close"></i></span>

      <!-- <form action="#" method="get" class="mobile-search">
          <label for="mobile-search" class="sr-only">Search</label>
          <input
            type="search"
            class="form-control"
            name="mobile-search"
            id="mobile-search"
            placeholder="Search in..."
            required
          />
          <button class="btn btn-primary" type="submit">
            <i class="icon-search"></i>
          </button>
        </form> -->

      <nav class="mobile-nav">
        <ul class="mobile-menu">
          <li class="active">
            <a href="/admin/">Home</a>
          </li>
          <li>
            <a href="">Categories</a>
            <ul>
              <li><a href="/admin/categorylist">Category Lists</a></li>
              <li><a href="/admin/addcategory">Add New Category</a></li>
            </ul>
          </li>
          <li>
            <a href="" class="sf-with-ul">Products</a>
            <ul>
              <li><a href="/admin/productslist">Product Lists</a></li>
              <li><a href="/admin/addproduct">Add New Product</a></li>
            </ul>
          </li>
          <li>
            <a href="/admin/userslist">Users</a>
          </li>
          <li>
            <a href="/admin/orderslist">Orders</a>
          </li>
        </ul>
      </nav>

      <div class="social-icons">
        <a href="#" class="social-icon" target="_blank" title="Facebook"><i class="icon-facebook-f"></i></a>
        <a href="#" class="social-icon" target="_blank" title="Twitter"><i class="icon-twitter"></i></a>
        <a href="#" class="social-icon" target="_blank" title="Instagram"><i class="icon-instagram"></i></a>
        <a href="#" class="social-icon" target="_blank" title="Youtube"><i class="icon-youtube"></i></a>
      </div>
    </div>
  </div>
  <script>
    
    function toggleActivation(productOfferId, isActive) {
  const url = isActive ? '/admin/deactivateproductoffer' : '/admin/activateproductoffer';
  
  fetch(url, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({ productOfferId })
  }).then(response => response.json())
    .then(data => {
      if (data.success) {
        console.log(data);
        const button = document.querySelector(`#product${productOfferId} .toggle-btn`);
        
        if (button) {

          if (isActive) {
            button.classList.remove('btn-danger');
            button.classList.add('btn-success');
            button.innerText = 'Activate';
            button.onclick = () => toggleActivation(productOfferId, false);
          } else {
            button.classList.remove('btn-success');
            button.classList.add('btn-danger');
            button.innerText = 'Deactivate';
            button.onclick = () => toggleActivation(productOfferId, true);
          }
        }
      }
    })
    .catch(error => {
      console.error('Error:', error);
    });
}


function toggleCategoryActivation(categoryOfferId, isActive) {
  const url = isActive ? '/admin/deactivatecategoryoffer' : '/admin/activatecategoryoffer';
  
  fetch(url, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({ categoryOfferId })
  }).then(response => response.json())
    .then(data => {
      if (data.success) {
        const button = document.querySelector(`#category${categoryOfferId} .toggle-btn`);
        
        if (button) {
          if (isActive) {
            button.classList.remove('btn-danger');
            button.classList.add('btn-success');
            button.innerText = 'Activate';
            button.onclick = () => toggleCategoryActivation(categoryOfferId, false);
          } else {
            button.classList.remove('btn-success');
            button.classList.add('btn-danger');
            button.innerText = 'Deactivate';
            button.onclick = () => toggleCategoryActivation(categoryOfferId, true);
          }
        }
      }
    })
    .catch(error => {
      console.error('Error:', error);
    });
}



    function deleteCategoryOffer(categoryofferId) {

      console.log(categoryofferId)

      fetch('/admin/deletecategoryoffer', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ categoryofferId })
      }).then(response => response.json())
        .then(data => {
          if (data.success) {
            document.getElementById('category' + categoryofferId).remove()

          }
        })

    }



    function deleteProductOffer(productOfferId) {


      fetch('/admin/deleteproductoffer', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ productOfferId })
      }).then(response => response.json())
        .then(data => {
          if (data.success) {
            document.getElementById('product' + productOfferId).remove()

          }
        })

    }
  </script>

  <script src="assets/js/jquery.min.js"></script>
  <script src="assets/js/bootstrap.bundle.min.js"></script>
  <script src="assets/js/jquery.hoverIntent.min.js"></script>
  <script src="assets/js/jquery.waypoints.min.js"></script>
  <script src="assets/js/superfish.min.js"></script>
  <script src="assets/js/owl.carousel.min.js"></script>
  <script src="assets/js/main.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
    crossorigin="anonymous"></script>

    <script src="https://cdn.datatables.net/v/bs5/jq-3.6.0/dt-1.13.4/sp-2.1.2/datatables.min.js"></script>
    <!-- General JS Scripts -->
    <script src="assets/js/app.min.js"></script>
    <!-- JS Libraies -->
    <script src="assets/bundles/apexcharts/apexcharts.min.js"></script>
    <!-- Page Specific JS File -->
    <script src="assets/js/page/index.js"></script>
    <!-- Template JS File -->
    <script src="assets/js/scripts.js"></script>
    <!-- Custom JS File -->
    <script src="assets/js/custom.js"></script>
</body>

</html>